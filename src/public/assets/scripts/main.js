angular.module("dias.ate",["dias.transects"]),angular.module("dias.ate").config(["$compileProvider",function(e){"use strict";e.debugInfoEnabled(!1)}]),angular.module("dias.ate").directive("ateFigure",function(){"use strict";return{restrict:"A",controller:["$scope","annotations","msg",function(e,t,n){e.handleClick=function(n){t.toggleDismiss(e.id)},e.isDismissed=function(){return t.isDismissed(e.id)},e.getClass=function(){return{"label-dismissed":e.isDismissed()}}}]}}),angular.module("dias.ate").controller("AteController",["$scope","TRANSECT_IMAGES","LABEL_MAP","labels","images",function(e,t,n,i,s){"use strict";var r=0,a=!1,l=function(e){if(e){var i=e.id;a=n.hasOwnProperty(i),t.length=0,a&&Array.prototype.push.apply(t,n[i]),s.updateFiltering(),s.scrollToPercent(0)}};e.annotationsExist=function(){return a},e.isInDismissMode=function(){return 0===r},e.hasSelectedLabel=i.hasSelectedLabel,e.getSelectedLabelName=function(){return i.getSelectedLabel().name},e.$watch(i.getSelectedLabel,l)}]),angular.module("dias.ate").service("annotations",["labels",function(e){"use strict";var t={},n=[],i=function(e){-1===n.indexOf(e)&&n.push(e)},s=function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)};this.toggleDismiss=function(n){var r=e.getSelectedLabel().id;if(t.hasOwnProperty(r)){var a=t[r].indexOf(n);-1!==a?(t[r].splice(a,1),s(n)):(t[r].push(n),i(n))}else t[r]=[n],i(n)},this.isDismissed=function(n){var i=e.getSelectedLabel().id;return t.hasOwnProperty(i)&&-1!==t[i].indexOf(n)},this.getDismissedIds=function(){return n}}]),angular.module("dias.ate").service("labels",["LABEL_TREES",function(e){"use strict";var t=[],n={},i=[],s=null,r=function(){for(var i,s=function(e){var t=e.parent_id;n[i][t]?n[i][t].push(e):n[i][t]=[e]},r=e.length-1;r>=0;r--)i=e[r].name,n[i]={},e[r].labels.forEach(s),t=t.concat(e[r].labels)},a=function(e){for(var n=t.length-1;n>=0;n--)if(t[n].id===e)return t[n];return null},l=function(e){var t=e;if(i.length=0,t)for(;null!==t.parent_id;)i.unshift(t.parent_id),t=a(t.parent_id)};this.getLabels=function(){return t},this.getLabelTrees=function(){return n},this.selectLabel=function(e){l(e),s=e},this.treeItemIsOpen=function(e){return-1!==i.indexOf(e.id)},this.treeItemIsSelected=function(e){return s&&s.id===e.id},this.getSelectedLabel=function(){return s},this.hasSelectedLabel=function(){return null!==s},r()}]);